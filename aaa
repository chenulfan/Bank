import React, { Component } from 'react';
import './App.css';
import { BrowserRouter as Router, Route, Link } from 'react-router-dom'
import axios from 'axios'
import Transactions from '../src/components/Transactions'
// import Transcations from './components/Transcations';
// import Operations from './components/Operations';
// import Landing from './components/Landing';
// import Sign from './components/Sign';

class App extends Component {
  constructor() {
    super()
    this.state = {
      arrTransactions: [],
      currentUser: localStorage.getItem("currentUser") || "",
    }
  }

  // async componentDidMount() {
  //   await this.getFromLocalStorage()
  // }
  // getFromLocalStorage = () => {
  //   let users = JSON.parse(localStorage.getItem("users"))
  //   let user = users.find(u => u.username === this.state.currentUser)
  //   this.setState({ arrTransactions: user.transcations })
  //   this.balance()
  // }
  addTransTocurrentUser = (transaction) => {
    let users = JSON.parse(localStorage.getItem("users"))
    console.log(users)
    let user = users.find(u => u.username === this.state.currentUser)
    user.transactions.push(transaction)
    localStorage.setItem("users" , JSON.stringify(users) )
    this.setState({arrTransactions: user.transactions})
  }


  // balance() {
  //   console.log(this.state.sum)
  //   const arrTransactions = this.state.arrTransactions
  //   let sum = 0
  //   arrTransactions.map(a => sum = sum + a.amount)
  //   this.setState({ sum: sum })
  // }
  // handleClick = async (obj) => {
  //   this.addToLocalStorage()
  //   // this.getFromDataBase()
  // }
  // handleCheck = (e) => {
  //   let check = e.target.value
  //   this.setState({ check })

  // }

  // filterToCategory = () => {
  //   const Trans = this.state.arrTransactions
  //   const Category = []
  //   Trans.map(a => Category.push(a.category))
  //   return [...new Set(Category)]
  // }

  // logUser = (username) => {
  //   this.setState({ username, approved: true })
  // }
  // addUser = async (user) => {
  //   await axios.post('http://localhost:8080/signup', user)
  // }
  // logOut = () => {
  //   localStorage.clear()
  //   this.setState({ username: "" })
  //   this.setState({ approved: false })
  // }
  render() {
    // const newUser = {username: "chen", transactions:[] }
    // let users = []
    // if(localStorage.getItem("users")!== null){
    //   users=JSON.parse(localStorage.getItem("users"))
    // }
    // users.push(newUser)
    // localStorage.setItem("users" , JSON.stringify(users) )
    // localStorage.setItem("currentUser" , "chen" )

    return (
      <Router>
        <Link className="ref" to="/">Home</Link>
        <Link className="ref" to="/sign">Sign In</Link>
        <h1> {this.state.currentUser} </h1>
        <Transactions addTransTocurrentUser={this.state.addTransTocurrentUser} />
      </Router>
    )
  }
}

export default App;



localStorage.setItem("users", "[{username: 'chen', transactions:[] }]")
localStorage.setItem("currentUser", "chen")